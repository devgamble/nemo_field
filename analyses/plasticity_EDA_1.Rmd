---
title: "Plasticity_EDA_1"
author: "Devin Gamble"
date: "2022-10-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Description:**  
This .Rmd will include exploratory data analyses (EDA) on the phenotypic plasticity of traits measured in four populations of *Nemophila menziesii* during the 2021-2022 growing season of the Mazer lab's Nemophila project. 



**Load Packages**  

```{r message = FALSE}
library(tidyverse) #For data organization and tidying
library(janitor) #more tidying functions
library(here) #great for specifying relative file paths
library(lubridate) #for adjusting 'date' values if any need cleaning up
#add more packages here


```



#### Load Fitness Plant Data  

**Bodega Bay**  

Load and tidy up data.
```{r}

BB_fitness_df1 <- read_csv(here::here("data_sheets", "compiled_sheets", "BB_mastersheet_v2_allFitness-only_2022-08-18.csv")) # You should edit the file path (i.e., edit/remove folder names) to load the csv from the folder you've stored it in


##Note on the data:
## This data frame includes data on all selected fitness plants at Bodega Bay from 2021-2022. There were 3 experimental blocks and a total of 156 (+1; 160) point-locations. Plants in block 'W' received supplemental water and had, when available, 3 fitness plants chosen. Recipient ID's (Genotypes) that were present in both the regular and water blocks had, when available, 3 fitness plants chosen (Replicated = R). Important trait-related columns include germination date, the number of closed fruit, number of total fruit, seed count, mean seed mass (msm_all), mean seeds per fruit, total estimated seed production, first flowering date (FFD), days from germination to flower, flowering duration, and survival.



##Remove Unnecessary columns and data
BB_fitness_df2 <- BB_fitness_df1 %>% 
  select(-c(Sequence, Co., FitP, any_FitP, F_multi, F_plant_notes, Fl_2.25:flr_P, seeds_weighed_d1:msm_d9))


#Keep only fitness plants that were replicated (Rep_FitP = TRUE) in both experiments
BB_fitness_df3 <- BB_fitness_df2 %>% 
  filter(Replicated == "R") %>% 
  mutate(watered = case_when(Block %in% c("1", "2", "3") ~ "n",
                             Block == "W" ~ "y")) %>% #create variable to indicate treatment
  mutate(FFD_DOY = yday(FFD))

```




#### Exploration  

```{r}




#Examine the structure of the data set

str(BB_fitness_df3)

head(BB_fitness_df3)

summary(BB_fitness_df3)


#Number of observations: watered vs unwatered
nrow(filter(BB_fitness_df3, watered == "n"))
```


**Some questions**:
- How many watered v.s. non-watered fitness plants (observations) are there?
- On average, how many fitness plants are there to each Recipient ID (in each block)?
- What kind of trends in quantitative/numeric trait variables can you identify?
- How do trait values differ across locations and between experiments?




```{r}
lm1 <- lm(FFD_DOY ~ watered, data = BB_fitness_df3)

summary(lm1)

anova(lm1)


#TukeyHSD(aov(lm1))

ggplot()
```


```{r}

library(lme4)

lm_er1 <- lmer(FFD_DOY ~ watered + (1|Location) + (1|Recipient), data = BB_fitness_df3)

summary(lm_er1)

anova(lm_er1)


ggplot(data = BB_fitness_df3) %>% 
  geom_jitter(aes(x = watered, y = fl_duration))

```



